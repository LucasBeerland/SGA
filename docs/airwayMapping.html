<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Lieven Clement" />


<title>Airway: Read Alignment and Count Table with QausR and Rhisat2</title>

<script src="site_libs/header-attrs-2.28/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>


<style type="text/css">
#rmd-source-code {
  display: none;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">SGA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-chalkboard-teacher"></span>
     
    Lectures
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">---- INTRODUCTION ----</li>
    <li>
      <a href="intro.html">1.1 Position</a>
    </li>
    <li>
      <a href="recapGeneralLinearModel.html">1.2 Recap linear model</a>
    </li>
    <li class="dropdown-header">---- MODULE I PROTEOMICS ----</li>
    <li>
      <a href="./figs/part1_ms_basics.pdf">1.1 MS Basics</a>
    </li>
    <li>
      <a href="./figs/part1_ms_basics.pdf">1.2 Identification</a>
    </li>
    <li>
      <a href="TargetDecoy.html">2.1 Identification - FDR - QC</a>
    </li>
    <li>
      <a href="pda_quantification_preprocessing.html">2.2.1 Quantification - Preprocessing</a>
    </li>
    <li>
      <a href="pda_robustSummarisation_peptideModels.html">2.2.2 Wrap-up Preprocessing - Peptide-Level-Models</a>
    </li>
    <li>
      <a href="pda_quantification_inference.html">2.3.1 Quantification - Differential Abundance Analysis</a>
    </li>
    <li>
      <a href="pda_blocking_wrapup.html">2.3.2. Wrap-up DA - Blocking</a>
    </li>
    <li>
      <a href="pda_technicalDetails.html">2.3.3. Technical Details</a>
    </li>
    <li class="dropdown-header">---- MODULE II RNA-seq ----</li>
    <li>
      <a href="sequencing_intro.html">1.  Introduction to RNA-seq</a>
    </li>
    <li>
      <a href="sequencing_countData.html">2.  Working with count data and GLMs</a>
    </li>
    <li>
      <a href="sequencing_technicalDE.html">3.  Technical Details</a>
    </li>
    <li>
      <a href="https://f1000research.com/articles/4-1521/v2">4. Starting from transcrip-level</a>
    </li>
    <li>
      <a href="sequencing_singleCell.html">6. Intro to scRNA-seq</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-laptop"></span>
     
    tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">---- INTRODUCTION ----</li>
    <li>
      <a href="multipleRegression_KPNA2.html">1 Intro KPNA2</a>
    </li>
    <li class="dropdown-header">---- MODULE I PROTEOMICS ----</li>
    <li>
      <a href="https://www.compomics.com/bioinformatics-for-proteomics/">1. Bioinformatics for Proteomics</a>
    </li>
    <li>
      <a href="TargetDecoyTutorial.html">2.1. Target Decoy QC</a>
    </li>
    <li>
      <a href="pda_tutorialPreprocessing.html">2.2. Quantification - Preprocessing</a>
    </li>
    <li>
      <a href="pda_tutorialDesign.html">2.3. Quantification - Design</a>
    </li>
    <li>
      <a href="sequencingTutorial1_mapping.html">1. Read mapping</a>
    </li>
    <li>
      <a href="sequencingTutorial2_DE.html">2. Working with Count Data</a>
    </li>
    <li>
      <a href="sequencingTutorial3_DE.html">4. Starting from transcript-level data</a>
    </li>
    <li>
      <a href="scRNA-seq-Tutorial.html">6. Tutorial scRNA-seq</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Airway: Read Alignment and Count Table with
QausR and Rhisat2</h1>
<h4 class="author">Lieven Clement</h4>
<h4 class="date">statOmics, Ghent University (<a
href="https://statomics.github.io"
class="uri">https://statomics.github.io</a>)</h4>

</div>


<div id="background" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Background</h1>
<p>The data used in this workflow comes from an RNA-seq experiment where
airway smooth muscle cells were treated with dexamethasone, a synthetic
glucocorticoid steroid with anti-inflammatory effects (Himes et
al. 2014). Glucocorticoids are used, for example, by people with asthma
to reduce inflammation of the airways. In the experiment, four human
airway smooth muscle cell lines were treated with 1 micromolar
dexamethasone for 18 hours. For each of the four cell lines, we have a
treated and an untreated sample. For more description of the experiment
see the article, PubMed entry 24926665, and for raw data see the GEO
entry <a
href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE52778">GSE52778</a>.</p>
<p>The information which connects the sample information from GEO with
the SRA run id is downloaded from <a
href="https://www.ncbi.nlm.nih.gov/sra?term=SRP033351">SRA</a> using the
Send to: File button.</p>
</div>
<div id="preprocessing" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Preprocessing</h1>
<div id="download-data" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Download Data</h2>
<p>For illustration purposes we will download subsampled fastq files
from the course github site.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>timeout <span class="ot">&lt;-</span> <span class="fu">options</span>()<span class="sc">$</span>timeout</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">options</span>(<span class="at">timeout =</span> <span class="dv">300</span>) <span class="co">#prevent timeout</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">&quot;https://github.com/statOmics/SGA/archive/refs/heads/airwaySeqData.zip&quot;</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>destFile <span class="ot">&lt;-</span> <span class="st">&quot;airway.zip&quot;</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">download.file</span>(url, destFile)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="fu">unzip</span>(destFile, <span class="at">exdir =</span> <span class="st">&quot;./&quot;</span>, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(destFile)) {</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>  <span class="co">#Delete file if it exists</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>  <span class="fu">file.remove</span>(destFile)</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">timeout =</span> timeout) <span class="co">#prevent timeout</span></span></code></pre></div>
</div>
<div id="assess-read-quality" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Assess Read
Quality</h2>
<p>Assess the fastq files with <a
href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/">fastQC</a>.</p>
</div>
<div id="align-data" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> Align data</h2>
<div id="input-file-for-hisat-aligner" class="section level3"
number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Input file for
hisat aligner</h3>
<p>We will make the input file for the hisat aligner that will be called
through the QUASAR package.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>fastqFiles <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">&quot;SGA-airwaySeqData/fastQ&quot;</span>,<span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">pattern =</span> <span class="st">&quot;fastq&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>forward <span class="ot">&lt;-</span> fastqFiles <span class="sc">%&gt;%</span> <span class="fu">grepl</span>(<span class="at">pattern=</span><span class="st">&quot;1.fastq&quot;</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>reverse <span class="ot">&lt;-</span> fastqFiles <span class="sc">%&gt;%</span> <span class="fu">grepl</span>(<span class="at">pattern=</span><span class="st">&quot;2.fastq&quot;</span>)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>samples <span class="ot">&lt;-</span> fastqFiles[forward] <span class="sc">|&gt;</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>    <span class="fu">substr</span>(<span class="at">start=</span><span class="dv">25</span>,<span class="at">stop=</span><span class="dv">34</span>) </span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>fileInfo <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">FileName1=</span>fastqFiles[forward],<span class="at">FileName2=</span>fastqFiles[reverse],<span class="at">SampleName=</span>samples)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>fileInfo</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["FileName1"],"name":[1],"type":["chr"],"align":["left"]},{"label":["FileName2"],"name":[2],"type":["chr"],"align":["left"]},{"label":["SampleName"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"SGA-airwaySeqData/fastQ/SRR1039508_subset_1.fastq","2":"SGA-airwaySeqData/fastQ/SRR1039508_subset_2.fastq","3":"SRR1039508"},{"1":"SGA-airwaySeqData/fastQ/SRR1039509_subset_1.fastq","2":"SGA-airwaySeqData/fastQ/SRR1039509_subset_2.fastq","3":"SRR1039509"},{"1":"SGA-airwaySeqData/fastQ/SRR1039512_subset_1.fastq","2":"SGA-airwaySeqData/fastQ/SRR1039512_subset_2.fastq","3":"SRR1039512"},{"1":"SGA-airwaySeqData/fastQ/SRR1039513_subset_1.fastq","2":"SGA-airwaySeqData/fastQ/SRR1039513_subset_2.fastq","3":"SRR1039513"},{"1":"SGA-airwaySeqData/fastQ/SRR1039516_subset_1.fastq","2":"SGA-airwaySeqData/fastQ/SRR1039516_subset_2.fastq","3":"SRR1039516"},{"1":"SGA-airwaySeqData/fastQ/SRR1039517_subset_1.fastq","2":"SGA-airwaySeqData/fastQ/SRR1039517_subset_2.fastq","3":"SRR1039517"},{"1":"SGA-airwaySeqData/fastQ/SRR1039520_subset_1.fastq","2":"SGA-airwaySeqData/fastQ/SRR1039520_subset_2.fastq","3":"SRR1039520"},{"1":"SGA-airwaySeqData/fastQ/SRR1039521_subset_1.fastq","2":"SGA-airwaySeqData/fastQ/SRR1039521_subset_2.fastq","3":"SRR1039521"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>We write the fileInfo to disk</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">write_tsv</span>(fileInfo,<span class="at">file=</span><span class="st">&quot;fastQfiles.txt&quot;</span>)</span></code></pre></div>
</div>
<div id="download-human-genome-and-gff3-file" class="section level3"
number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Download human
genome and gff3 file</h3>
<p>All reads in the subsampled fastq files map to chromosome 1. So
download genome and annotation data for chromosome 1 only.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>timeout <span class="ot">&lt;-</span> <span class="fu">options</span>()<span class="sc">$</span>timeout</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">options</span>(<span class="at">timeout =</span> <span class="dv">500</span>) <span class="co">#prevent timeout</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>urlGenome <span class="ot">&lt;-</span> <span class="st">&quot;https://ftp.ensembl.org/pub/release-113/fasta/homo_sapiens/dna/Homo_sapiens.GRCh38.dna.chromosome.1.fa.gz&quot;</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>genomeDestFile <span class="ot">&lt;-</span> <span class="st">&quot;Homo_sapiens.GRCh38.dna.chromosome.1.fa.gz&quot;</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>urlGff <span class="ot">&lt;-</span> <span class="st">&quot;https://ftp.ensembl.org/pub/release-113/gff3/homo_sapiens/Homo_sapiens.GRCh38.113.chromosome.1.gff3.gz&quot;</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>gffDestFile <span class="ot">&lt;-</span> <span class="st">&quot;Homo_sapiens.GRCh38.113.chromosome.1.gff3.gz&quot;</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="fu">download.file</span>(<span class="at">url =</span> urlGenome ,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>              <span class="at">destfile =</span> genomeDestFile)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="fu">download.file</span>(<span class="at">url =</span> urlGff,</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>              <span class="at">destfile =</span> gffDestFile)</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="fu">gunzip</span>(genomeDestFile, <span class="at">overwrite =</span> <span class="cn">TRUE</span>, <span class="at">remove=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="fu">gunzip</span>(gffDestFile, <span class="at">overwrite =</span> <span class="cn">TRUE</span>, <span class="at">remove=</span><span class="cn">TRUE</span>)</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="fu">list.files</span>()</span></code></pre></div>
<pre><code>##  [1] &quot;_session-info.Rmd&quot;                        
##  [2] &quot;_site.yml&quot;                                
##  [3] &quot;about.html&quot;                               
##  [4] &quot;about.Rmd&quot;                                
##  [5] &quot;airway_files&quot;                             
##  [6] &quot;airway_salmon_edgeR_files&quot;                
##  [7] &quot;airway_salmon_edgeR.html&quot;                 
##  [8] &quot;airway_salmon_edgeR.Rmd&quot;                  
##  [9] &quot;airway.html&quot;                              
## [10] &quot;airway.rmd&quot;                               
## [11] &quot;airwayMapping.Rmd&quot;                        
## [12] &quot;bibliography.bib&quot;                         
## [13] &quot;cancer3x3.Rmd&quot;                            
## [14] &quot;cancer6x6.Rmd&quot;                            
## [15] &quot;cancer9x9.Rmd&quot;                            
## [16] &quot;cptac_maxLFQ.Rmd&quot;                         
## [17] &quot;cptac_median.Rmd&quot;                         
## [18] &quot;cptac_robust_gui.Rmd&quot;                     
## [19] &quot;cptac_robust.Rmd&quot;                         
## [20] &quot;docs&quot;                                     
## [21] &quot;elegansAlignmentCountTable.Rmd&quot;           
## [22] &quot;elegansDE.Rmd&quot;                            
## [23] &quot;fastQfiles.txt&quot;                           
## [24] &quot;figs&quot;                                     
## [25] &quot;figures&quot;                                  
## [26] &quot;figures.tar.gz&quot;                           
## [27] &quot;footer.html&quot;                              
## [28] &quot;heartMainInteraction.Rmd&quot;                 
## [29] &quot;Homo_sapiens.GRCh38.113.chromosome.1.gff3&quot;
## [30] &quot;Homo_sapiens.GRCh38.dna.chromosome.1.fa&quot;  
## [31] &quot;images_sequencing&quot;                        
## [32] &quot;index.Rmd&quot;                                
## [33] &quot;install.R&quot;                                
## [34] &quot;intro.Rmd&quot;                                
## [35] &quot;msqrob2.bib&quot;                              
## [36] &quot;multipleRegression_KPNA2.Rmd&quot;             
## [37] &quot;mzIDMsgfSwissprotExample.Rmd&quot;             
## [38] &quot;mzIDswissprotTutorial.Rmd&quot;                
## [39] &quot;mzIDuniprotTutorial.Rmd&quot;                  
## [40] &quot;parathyroid.Rmd&quot;                          
## [41] &quot;pda_blocking_wrapup.Rmd&quot;                  
## [42] &quot;pda_quantification_inference.Rmd&quot;         
## [43] &quot;pda_quantification_preprocessing.Rmd&quot;     
## [44] &quot;pda_robustSummarisation_peptideModels.Rmd&quot;
## [45] &quot;pda_technicalDetails.Rmd&quot;                 
## [46] &quot;pda_tutorialDesign.Rmd&quot;                   
## [47] &quot;pda_tutorialPreprocessing.Rmd&quot;            
## [48] &quot;README.md&quot;                                
## [49] &quot;recapGeneralLinearModel.Rmd&quot;              
## [50] &quot;rmdBub&quot;                                   
## [51] &quot;scRNA-seq-Tutorial.Rmd&quot;                   
## [52] &quot;sequencing_countData.Rmd&quot;                 
## [53] &quot;sequencing_intro.Rmd&quot;                     
## [54] &quot;sequencing_singleCell.Rmd&quot;                
## [55] &quot;sequencing_technicalDE.Rmd&quot;               
## [56] &quot;sequencingTutorial1_mapping.Rmd&quot;          
## [57] &quot;sequencingTutorial2_DE.Rmd&quot;               
## [58] &quot;sequencingTutorial3_DE.Rmd&quot;               
## [59] &quot;SGA-airwaySeqData&quot;                        
## [60] &quot;SGA-airwaySeqData.zip&quot;                    
## [61] &quot;singleCell_MacoskoWorkflow_blank.Rmd&quot;     
## [62] &quot;site_libs&quot;                                
## [63] &quot;style.css&quot;                                
## [64] &quot;TargetDecoy.Rmd&quot;                          
## [65] &quot;TargetDecoyTutorial.Rmd&quot;</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">options</span>(<span class="at">timeout =</span> timeout) <span class="co">#prevent timeout</span></span></code></pre></div>
</div>
<div id="align-reads-using-quasr-and-rhisat-package"
class="section level3" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Align reads using
QuasR and RHisat package</h3>
<ul>
<li><p>We are aligning RNA-seq reads and have to use a gap aware
alignment modus. We therefore use the argument
<code>splicedAlignment = TRUE</code></p></li>
<li><p>The project is a single-end sequencing project! So we use the
argument <code>paired = "no"</code>.</p></li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>    <span class="fu">library</span>(QuasR)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>    <span class="fu">library</span>(Rhisat2)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>})</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>sampleFile <span class="ot">&lt;-</span> <span class="st">&quot;fastQfiles.txt&quot;</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>genomeFile <span class="ot">&lt;-</span> <span class="st">&quot;Homo_sapiens.GRCh38.dna.chromosome.1.fa&quot;</span>    </span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>projAirway <span class="ot">&lt;-</span> <span class="fu">qAlign</span>(</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>    <span class="at">sampleFile =</span> sampleFile, </span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>    <span class="at">genome =</span> genomeFile,</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>    <span class="at">splicedAlignment =</span> <span class="cn">TRUE</span>, </span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>    <span class="at">aligner =</span> <span class="st">&quot;Rhisat2&quot;</span>,</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>    <span class="at">paired=</span><span class="st">&quot;fr&quot;</span>)</span></code></pre></div>
<pre><code>## Creating .fai file for: /Users/lclement/Dropbox/statOmics/SGA/Homo_sapiens.GRCh38.dna.chromosome.1.fa</code></pre>
<pre><code>## alignment files missing - need to:</code></pre>
<pre><code>##     create alignment index for the genome</code></pre>
<pre><code>##     create 8 genomic alignment(s)</code></pre>
<pre><code>## Creating an Rhisat2 index for /Users/lclement/Dropbox/statOmics/SGA/Homo_sapiens.GRCh38.dna.chromosome.1.fa</code></pre>
<pre><code>## Finished creating index</code></pre>
<pre><code>## Testing the compute nodes...OK
## Loading QuasR on the compute nodes...preparing to run on 1 nodes...done
## Available cores:
## w039h001.wireless.ugent.be: 1
## Performing genomic alignments for 8 samples. See progress in the log file:
## /Users/lclement/Dropbox/statOmics/SGA/QuasR_log_b3d05cc4dab1.txt
## Genomic alignments have been created successfully</code></pre>
</div>
</div>
<div id="make-count-table" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Make count table</h2>
<div id="convert-gff-file-into-database" class="section level3"
number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Convert gff file
into database</h3>
<p>The gff3 file contains information on the position of features,
e.g. exons and genes, along the chromosome.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">library</span>(GenomicFeatures)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="fu">library</span>(Rsamtools)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>})</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>annotFile <span class="ot">&lt;-</span> <span class="st">&quot;Homo_sapiens.GRCh38.113.chromosome.1.gff3&quot;</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#chrLen &lt;- scanFaIndex(genomeFile)</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#chrominfo &lt;- data.frame(chrom = as.character(seqnames(chrLen)),</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="co">#                        length = width(chrLen),</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#                        is_circular = rep(FALSE, length(chrLen)))</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>txdb <span class="ot">&lt;-</span> <span class="fu">makeTxDbFromGFF</span>(<span class="at">file =</span> annotFile,</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>                        <span class="at">dataSource =</span> <span class="st">&quot;Ensembl&quot;</span>,</span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>                        <span class="at">organism =</span> <span class="st">&quot;Homo sapiens&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in call_fun_in_txdbmaker(&quot;makeTxDbFromGFF&quot;, ...): makeTxDbFromGFF() has moved to the txdbmaker package. Please call
##   txdbmaker::makeTxDbFromGFF() to get rid of this warning.</code></pre>
<pre><code>## Import genomic features from the file as a GRanges object ... OK
## Prepare the &#39;metadata&#39; data frame ... OK
## Make the TxDb object ... OK</code></pre>
</div>
<div id="make-gene-count-table" class="section level3" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Make Gene Count
table</h3>
<p>With the qCount function we can count the overlap between the aligned
reads and the genomic features of interest.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>geneCounts <span class="ot">&lt;-</span> <span class="fu">qCount</span>(projAirway, txdb, <span class="at">reportLevel =</span> <span class="st">&quot;gene&quot;</span>)</span></code></pre></div>
<pre><code>## extracting gene regions from TxDb...done
## counting alignments...done
## collapsing counts by query name...done</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">head</span>(geneCounts)</span></code></pre></div>
<pre><code>##                 width SRR1039508 SRR1039509 SRR1039512 SRR1039513 SRR1039516
## ENSG00000000457  6883          0          0          0          0          0
## ENSG00000000460  5970          0          0          0          0          0
## ENSG00000000938  3382          0          0          0          0          0
## ENSG00000000971 15284          0          0          0          0          0
## ENSG00000001460  8511          0          0          0          0          0
## ENSG00000001461 11672          0          0          0          0          0
##                 SRR1039517 SRR1039520 SRR1039521
## ENSG00000000457          0          0          0
## ENSG00000000460          0          0          0
## ENSG00000000938          0          0          0
## ENSG00000000971          0          0          0
## ENSG00000001460          0          0          0
## ENSG00000001461          0          0          0</code></pre>
<p>Save count table for future use.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">write.csv</span>(<span class="fu">as.data.frame</span>(geneCounts),<span class="at">file =</span> <span class="st">&quot;airwayCountTable.csv&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>
<div id="session-info" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Session Info</h1>
<p>With respect to reproducibility, it is highly recommended to include
a session info in your script so that readers of your output can see
your particular setup of R.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code></pre></div>
<pre><code>## R version 4.4.0 RC (2024-04-16 r86468)
## Platform: aarch64-apple-darwin20
## Running under: macOS Big Sur 11.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib 
## LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## time zone: Europe/Brussels
## tzcode source: internal
## 
## attached base packages:
## [1] stats4    parallel  stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] Rsamtools_2.20.0       Biostrings_2.72.1      XVector_0.44.0        
##  [4] GenomicFeatures_1.56.0 AnnotationDbi_1.66.0   Biobase_2.64.0        
##  [7] Rhisat2_1.20.0         QuasR_1.44.0           Rbowtie_1.44.0        
## [10] GenomicRanges_1.56.1   GenomeInfoDb_1.40.1    IRanges_2.38.1        
## [13] S4Vectors_0.42.1       BiocGenerics_0.50.0    R.utils_2.12.3        
## [16] R.oo_1.26.0            R.methodsS3_1.8.2      lubridate_1.9.3       
## [19] forcats_1.0.0          stringr_1.5.1          dplyr_1.1.4           
## [22] purrr_1.0.2            readr_2.1.5            tidyr_1.3.1           
## [25] tibble_3.2.1           ggplot2_3.5.1          tidyverse_2.0.0       
## 
## loaded via a namespace (and not attached):
##  [1] DBI_1.2.3                   bitops_1.0-8               
##  [3] deldir_2.0-4                httr2_1.0.5                
##  [5] biomaRt_2.60.1              rlang_1.1.4                
##  [7] magrittr_2.0.3              matrixStats_1.4.1          
##  [9] compiler_4.4.0              RSQLite_2.3.7              
## [11] txdbmaker_1.0.1             png_0.1-8                  
## [13] vctrs_0.6.5                 pwalign_1.0.0              
## [15] pkgconfig_2.0.3             crayon_1.5.3               
## [17] fastmap_1.2.0               dbplyr_2.5.0               
## [19] utf8_1.2.4                  rmarkdown_2.28             
## [21] tzdb_0.4.0                  UCSC.utils_1.0.0           
## [23] bit_4.5.0                   xfun_0.47                  
## [25] zlibbioc_1.50.0             cachem_1.1.0               
## [27] jsonlite_1.8.9              progress_1.2.3             
## [29] blob_1.2.4                  DelayedArray_0.30.1        
## [31] BiocParallel_1.38.0         jpeg_0.1-10                
## [33] prettyunits_1.2.0           R6_2.5.1                   
## [35] VariantAnnotation_1.50.0    bslib_0.8.0                
## [37] stringi_1.8.4               RColorBrewer_1.1-3         
## [39] rtracklayer_1.64.0          jquerylib_0.1.4            
## [41] Rcpp_1.0.13-1               SummarizedExperiment_1.34.0
## [43] knitr_1.48                  SGSeq_1.38.0               
## [45] igraph_2.0.3                Matrix_1.7-0               
## [47] timechange_0.3.0            tidyselect_1.2.1           
## [49] rstudioapi_0.16.0           abind_1.4-8                
## [51] yaml_2.3.10                 codetools_0.2-20           
## [53] RUnit_0.4.33                hwriter_1.3.2.1            
## [55] curl_5.2.3                  lattice_0.22-6             
## [57] withr_3.0.1                 ShortRead_1.62.0           
## [59] KEGGREST_1.44.1             evaluate_1.0.0             
## [61] BiocFileCache_2.12.0        xml2_1.3.6                 
## [63] filelock_1.0.3              pillar_1.9.0               
## [65] MatrixGenerics_1.16.0       generics_0.1.3             
## [67] vroom_1.6.5                 RCurl_1.98-1.16            
## [69] hms_1.1.3                   munsell_0.5.1              
## [71] scales_1.3.0                GenomicFiles_1.40.0        
## [73] glue_1.8.0                  tools_4.4.0                
## [75] interp_1.1-6                BiocIO_1.14.0              
## [77] BSgenome_1.72.0             GenomicAlignments_1.40.0   
## [79] XML_3.99-0.17               grid_4.4.0                 
## [81] latticeExtra_0.6-30         colorspace_2.1-1           
## [83] GenomeInfoDbData_1.2.12     restfulr_0.0.15            
## [85] cli_3.6.3                   rappdirs_0.3.3             
## [87] fansi_1.0.6                 S4Arrays_1.4.1             
## [89] gtable_0.3.5                sass_0.4.9                 
## [91] digest_0.6.37               SparseArray_1.4.8          
## [93] rjson_0.2.23                memoise_2.0.1              
## [95] htmltools_0.5.8.1           lifecycle_1.0.4            
## [97] httr_1.4.7                  bit64_4.5.2</code></pre>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiQWlyd2F5OiBSZWFkIEFsaWdubWVudCBhbmQgQ291bnQgVGFibGUgd2l0aCBRYXVzUiBhbmQgUmhpc2F0MiIKYXV0aG9yOiAiTGlldmVuIENsZW1lbnQiCmRhdGU6ICJzdGF0T21pY3MsIEdoZW50IFVuaXZlcnNpdHkgKGh0dHBzOi8vc3RhdG9taWNzLmdpdGh1Yi5pbykiCm91dHB1dDoKICAgIGh0bWxfZG9jdW1lbnQ6CiAgICAgIGNvZGVfZG93bmxvYWQ6IHRydWUKICAgICAgdGhlbWU6IGZsYXRseQogICAgICB0b2M6IHRydWUKICAgICAgdG9jX2Zsb2F0OiB0cnVlCiAgICAgIGhpZ2hsaWdodDogdGFuZ28KICAgICAgbnVtYmVyX3NlY3Rpb25zOiB0cnVlCmxpbmtjb2xvcjogYmx1ZQp1cmxjb2xvcjogYmx1ZQpjaXRlY29sb3I6IGJsdWUKLS0tCgpgYGB7ciwgZWNobz1GQUxTRX0Kc3VwcHJlc3NQYWNrYWdlU3RhcnR1cE1lc3NhZ2VzKHsKICBsaWJyYXJ5KHRpZHl2ZXJzZSkKICBsaWJyYXJ5KFIudXRpbHMpCn0pCmBgYAojIEJhY2tncm91bmQgCgpUaGUgZGF0YSB1c2VkIGluIHRoaXMgd29ya2Zsb3cgY29tZXMgZnJvbSBhbiBSTkEtc2VxIGV4cGVyaW1lbnQgd2hlcmUgYWlyd2F5IHNtb290aCBtdXNjbGUgY2VsbHMgd2VyZSB0cmVhdGVkIHdpdGggZGV4YW1ldGhhc29uZSwgYSBzeW50aGV0aWMgZ2x1Y29jb3J0aWNvaWQgc3Rlcm9pZCB3aXRoIGFudGktaW5mbGFtbWF0b3J5IGVmZmVjdHMgKEhpbWVzIGV0IGFsLiAyMDE0KS4gR2x1Y29jb3J0aWNvaWRzIGFyZSB1c2VkLCBmb3IgZXhhbXBsZSwgYnkgcGVvcGxlIHdpdGggYXN0aG1hIHRvIHJlZHVjZSBpbmZsYW1tYXRpb24gb2YgdGhlIGFpcndheXMuIEluIHRoZSBleHBlcmltZW50LCBmb3VyIGh1bWFuIGFpcndheSBzbW9vdGggbXVzY2xlIGNlbGwgbGluZXMgd2VyZSB0cmVhdGVkIHdpdGggMSBtaWNyb21vbGFyIGRleGFtZXRoYXNvbmUgZm9yIDE4IGhvdXJzLiBGb3IgZWFjaCBvZiB0aGUgZm91ciBjZWxsIGxpbmVzLCB3ZSBoYXZlIGEgdHJlYXRlZCBhbmQgYW4gdW50cmVhdGVkIHNhbXBsZS4KRm9yIG1vcmUgZGVzY3JpcHRpb24gb2YgdGhlIGV4cGVyaW1lbnQgc2VlIHRoZSBhcnRpY2xlLCBQdWJNZWQgZW50cnkgMjQ5MjY2NjUsIGFuZCBmb3IgcmF3IGRhdGEgc2VlIHRoZSBHRU8gZW50cnkgW0dTRTUyNzc4XShodHRwczovL3d3dy5uY2JpLm5sbS5uaWguZ292L2dlby9xdWVyeS9hY2MuY2dpP2FjYz1HU0U1Mjc3OCkuIAoKClRoZSBpbmZvcm1hdGlvbiB3aGljaCBjb25uZWN0cyB0aGUgc2FtcGxlIGluZm9ybWF0aW9uIGZyb20gR0VPIHdpdGggdGhlIFNSQSBydW4gaWQgaXMgZG93bmxvYWRlZCBmcm9tIFtTUkFdKGh0dHBzOi8vd3d3Lm5jYmkubmxtLm5paC5nb3Yvc3JhP3Rlcm09U1JQMDMzMzUxKSB1c2luZyB0aGUgU2VuZCB0bzogRmlsZSBidXR0b24uCgoKIyBQcmVwcm9jZXNzaW5nIAoKIyMgRG93bmxvYWQgRGF0YSAKCgpGb3IgaWxsdXN0cmF0aW9uIHB1cnBvc2VzIHdlIHdpbGwgZG93bmxvYWQgc3Vic2FtcGxlZCBmYXN0cSBmaWxlcyBmcm9tIHRoZSBjb3Vyc2UgZ2l0aHViIHNpdGUuIAoKCmBgYHtyfQp0aW1lb3V0IDwtIG9wdGlvbnMoKSR0aW1lb3V0Cm9wdGlvbnModGltZW91dCA9IDMwMCkgI3ByZXZlbnQgdGltZW91dAoKdXJsIDwtICJodHRwczovL2dpdGh1Yi5jb20vc3RhdE9taWNzL1NHQS9hcmNoaXZlL3JlZnMvaGVhZHMvYWlyd2F5U2VxRGF0YS56aXAiCmRlc3RGaWxlIDwtICJhaXJ3YXkuemlwIgoKZG93bmxvYWQuZmlsZSh1cmwsIGRlc3RGaWxlKQoKdW56aXAoZGVzdEZpbGUsIGV4ZGlyID0gIi4vIiwgb3ZlcndyaXRlID0gVFJVRSkKCmlmIChmaWxlLmV4aXN0cyhkZXN0RmlsZSkpIHsKICAjRGVsZXRlIGZpbGUgaWYgaXQgZXhpc3RzCiAgZmlsZS5yZW1vdmUoZGVzdEZpbGUpCn0KCm9wdGlvbnModGltZW91dCA9IHRpbWVvdXQpICNwcmV2ZW50IHRpbWVvdXQKYGBgCgojIyBBc3Nlc3MgUmVhZCBRdWFsaXR5IAoKQXNzZXNzIHRoZSBmYXN0cSBmaWxlcyB3aXRoIFtmYXN0UUNdKGh0dHBzOi8vd3d3LmJpb2luZm9ybWF0aWNzLmJhYnJhaGFtLmFjLnVrL3Byb2plY3RzL2Zhc3RxYy8pLiAKCiMjIEFsaWduIGRhdGEKCiMjIyBJbnB1dCBmaWxlIGZvciBoaXNhdCBhbGlnbmVyCgpXZSB3aWxsIG1ha2UgdGhlIGlucHV0IGZpbGUgZm9yIHRoZSBoaXNhdCBhbGlnbmVyIHRoYXQgd2lsbCBiZSBjYWxsZWQgdGhyb3VnaCB0aGUgUVVBU0FSIHBhY2thZ2UuIAoKYGBge3J9CmZhc3RxRmlsZXMgPC0gbGlzdC5maWxlcyhwYXRoID0gIlNHQS1haXJ3YXlTZXFEYXRhL2Zhc3RRIixmdWxsLm5hbWVzID0gVFJVRSwgcGF0dGVybiA9ICJmYXN0cSIpCgpmb3J3YXJkIDwtIGZhc3RxRmlsZXMgJT4lIGdyZXBsKHBhdHRlcm49IjEuZmFzdHEiKQpyZXZlcnNlIDwtIGZhc3RxRmlsZXMgJT4lIGdyZXBsKHBhdHRlcm49IjIuZmFzdHEiKQpzYW1wbGVzIDwtIGZhc3RxRmlsZXNbZm9yd2FyZF0gfD4KICAgIHN1YnN0cihzdGFydD0yNSxzdG9wPTM0KSAKZmlsZUluZm8gPC0gdGliYmxlKEZpbGVOYW1lMT1mYXN0cUZpbGVzW2ZvcndhcmRdLEZpbGVOYW1lMj1mYXN0cUZpbGVzW3JldmVyc2VdLFNhbXBsZU5hbWU9c2FtcGxlcykKZmlsZUluZm8KYGBgCgpXZSB3cml0ZSB0aGUgZmlsZUluZm8gdG8gZGlzayAKCmBgYHtyfQp3cml0ZV90c3YoZmlsZUluZm8sZmlsZT0iZmFzdFFmaWxlcy50eHQiKQpgYGAKCiMjIyBEb3dubG9hZCBodW1hbiBnZW5vbWUgYW5kIGdmZjMgZmlsZSAKCkFsbCByZWFkcyBpbiB0aGUgc3Vic2FtcGxlZCBmYXN0cSBmaWxlcyBtYXAgdG8gY2hyb21vc29tZSAxLgpTbyBkb3dubG9hZCBnZW5vbWUgYW5kIGFubm90YXRpb24gZGF0YSBmb3IgY2hyb21vc29tZSAxIG9ubHkuIAoKYGBge3J9CnRpbWVvdXQgPC0gb3B0aW9ucygpJHRpbWVvdXQKb3B0aW9ucyh0aW1lb3V0ID0gNTAwKSAjcHJldmVudCB0aW1lb3V0Cgp1cmxHZW5vbWUgPC0gImh0dHBzOi8vZnRwLmVuc2VtYmwub3JnL3B1Yi9yZWxlYXNlLTExMy9mYXN0YS9ob21vX3NhcGllbnMvZG5hL0hvbW9fc2FwaWVucy5HUkNoMzguZG5hLmNocm9tb3NvbWUuMS5mYS5neiIKZ2Vub21lRGVzdEZpbGUgPC0gIkhvbW9fc2FwaWVucy5HUkNoMzguZG5hLmNocm9tb3NvbWUuMS5mYS5neiIKdXJsR2ZmIDwtICJodHRwczovL2Z0cC5lbnNlbWJsLm9yZy9wdWIvcmVsZWFzZS0xMTMvZ2ZmMy9ob21vX3NhcGllbnMvSG9tb19zYXBpZW5zLkdSQ2gzOC4xMTMuY2hyb21vc29tZS4xLmdmZjMuZ3oiCmdmZkRlc3RGaWxlIDwtICJIb21vX3NhcGllbnMuR1JDaDM4LjExMy5jaHJvbW9zb21lLjEuZ2ZmMy5neiIKCmRvd25sb2FkLmZpbGUodXJsID0gdXJsR2Vub21lICwKICAgICAgICAgICAgICBkZXN0ZmlsZSA9IGdlbm9tZURlc3RGaWxlKQpkb3dubG9hZC5maWxlKHVybCA9IHVybEdmZiwKICAgICAgICAgICAgICBkZXN0ZmlsZSA9IGdmZkRlc3RGaWxlKQpndW56aXAoZ2Vub21lRGVzdEZpbGUsIG92ZXJ3cml0ZSA9IFRSVUUsIHJlbW92ZT1UUlVFKQpndW56aXAoZ2ZmRGVzdEZpbGUsIG92ZXJ3cml0ZSA9IFRSVUUsIHJlbW92ZT1UUlVFKQpsaXN0LmZpbGVzKCkKb3B0aW9ucyh0aW1lb3V0ID0gdGltZW91dCkgI3ByZXZlbnQgdGltZW91dAoKYGBgCgojIyMgQWxpZ24gcmVhZHMgdXNpbmcgUXVhc1IgYW5kIFJIaXNhdCBwYWNrYWdlCgotIFdlIGFyZSBhbGlnbmluZyBSTkEtc2VxIHJlYWRzIGFuZCBoYXZlIHRvIHVzZSBhIGdhcCBhd2FyZSBhbGlnbm1lbnQgbW9kdXMuIFdlIHRoZXJlZm9yZSB1c2UgdGhlIGFyZ3VtZW50IGBzcGxpY2VkQWxpZ25tZW50ID0gVFJVRWAKCi0gVGhlIHByb2plY3QgaXMgYSBzaW5nbGUtZW5kIHNlcXVlbmNpbmcgcHJvamVjdCEgU28gd2UgdXNlIHRoZSBhcmd1bWVudCBgcGFpcmVkID0gIm5vImAuCgpgYGB7cn0Kc3VwcHJlc3NQYWNrYWdlU3RhcnR1cE1lc3NhZ2VzKHsKICAgIGxpYnJhcnkoUXVhc1IpCiAgICBsaWJyYXJ5KFJoaXNhdDIpCn0pCnNhbXBsZUZpbGUgPC0gImZhc3RRZmlsZXMudHh0IgpnZW5vbWVGaWxlIDwtICJIb21vX3NhcGllbnMuR1JDaDM4LmRuYS5jaHJvbW9zb21lLjEuZmEiICAgIApwcm9qQWlyd2F5IDwtIHFBbGlnbigKICAgIHNhbXBsZUZpbGUgPSBzYW1wbGVGaWxlLCAKICAgIGdlbm9tZSA9IGdlbm9tZUZpbGUsCiAgICBzcGxpY2VkQWxpZ25tZW50ID0gVFJVRSwgCiAgICBhbGlnbmVyID0gIlJoaXNhdDIiLAogICAgcGFpcmVkPSJmciIpCmBgYAoKIyMgTWFrZSBjb3VudCB0YWJsZQoKIyMjIENvbnZlcnQgZ2ZmIGZpbGUgaW50byBkYXRhYmFzZQoKVGhlIGdmZjMgZmlsZSBjb250YWlucyBpbmZvcm1hdGlvbiBvbiB0aGUgcG9zaXRpb24gb2YgZmVhdHVyZXMsIGUuZy4gZXhvbnMgYW5kIGdlbmVzLCBhbG9uZyB0aGUgY2hyb21vc29tZS4gCgpgYGB7cn0Kc3VwcHJlc3NQYWNrYWdlU3RhcnR1cE1lc3NhZ2VzKHsKbGlicmFyeShHZW5vbWljRmVhdHVyZXMpCmxpYnJhcnkoUnNhbXRvb2xzKQp9KQphbm5vdEZpbGUgPC0gIkhvbW9fc2FwaWVucy5HUkNoMzguMTEzLmNocm9tb3NvbWUuMS5nZmYzIgoKI2NockxlbiA8LSBzY2FuRmFJbmRleChnZW5vbWVGaWxlKQoKI2Nocm9taW5mbyA8LSBkYXRhLmZyYW1lKGNocm9tID0gYXMuY2hhcmFjdGVyKHNlcW5hbWVzKGNockxlbikpLAojICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoID0gd2lkdGgoY2hyTGVuKSwKIyAgICAgICAgICAgICAgICAgICAgICAgIGlzX2NpcmN1bGFyID0gcmVwKEZBTFNFLCBsZW5ndGgoY2hyTGVuKSkpCgp0eGRiIDwtIG1ha2VUeERiRnJvbUdGRihmaWxlID0gYW5ub3RGaWxlLAogICAgICAgICAgICAgICAgICAgICAgICBkYXRhU291cmNlID0gIkVuc2VtYmwiLAogICAgICAgICAgICAgICAgICAgICAgICBvcmdhbmlzbSA9ICJIb21vIHNhcGllbnMiKQpgYGAKCiMjIyBNYWtlIEdlbmUgQ291bnQgdGFibGUgCgpXaXRoIHRoZSBxQ291bnQgZnVuY3Rpb24gd2UgY2FuIGNvdW50IHRoZSBvdmVybGFwIGJldHdlZW4gdGhlIGFsaWduZWQgcmVhZHMgYW5kIHRoZSBnZW5vbWljIGZlYXR1cmVzIG9mIGludGVyZXN0LiAKCmBgYHtyfQpnZW5lQ291bnRzIDwtIHFDb3VudChwcm9qQWlyd2F5LCB0eGRiLCByZXBvcnRMZXZlbCA9ICJnZW5lIikKaGVhZChnZW5lQ291bnRzKQpgYGAKClNhdmUgY291bnQgdGFibGUgZm9yIGZ1dHVyZSB1c2UuIAoKYGBge3J9CndyaXRlLmNzdihhcy5kYXRhLmZyYW1lKGdlbmVDb3VudHMpLGZpbGUgPSAiYWlyd2F5Q291bnRUYWJsZS5jc3YiKQpgYGAKCgojIFNlc3Npb24gSW5mbwoKV2l0aCByZXNwZWN0IHRvIHJlcHJvZHVjaWJpbGl0eSwgaXQgaXMgaGlnaGx5IHJlY29tbWVuZGVkIHRvIGluY2x1ZGUgYSBzZXNzaW9uIGluZm8gaW4geW91ciBzY3JpcHQgc28gdGhhdCByZWFkZXJzIG9mIHlvdXIgb3V0cHV0IGNhbiBzZWUgeW91ciBwYXJ0aWN1bGFyIHNldHVwIG9mIFIuIAoKYGBge3J9CnNlc3Npb25JbmZvKCkKYGBgCgo=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("airwayMapping.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
